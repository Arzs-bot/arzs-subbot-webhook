import { buffer } from 'micro';

export const config = {
  api: { bodyParser: false }
};

export default async function handler(req, res) {
  const rawBody = await buffer(req);
  const jsonBody = JSON.parse(rawBody.toString());

  const events = jsonBody.events || [];

  for (const event of events) {
    const source = event.source || {};
    console.log("ğŸ“¥ æ”¶åˆ°äº‹ä»¶ï¼š", JSON.stringify(event, null, 2));
    console.log("ğŸ‘¥ ä¾†æº type:", source.type);
    console.log("ğŸ‘¤ userId:", source.userId || "ç„¡");
    console.log("ğŸ‘¥ groupId:", source.groupId || "âŒ ç„¡ groupId");
  }

  res.status(200).send("OK");
}
